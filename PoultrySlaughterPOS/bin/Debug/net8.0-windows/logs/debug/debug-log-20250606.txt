[2025-06-06 03:09:49.094 +03:00 INF] : === Poultry Slaughter POS Application Starting ===
[2025-06-06 03:09:49.239 +03:00 INF] : Startup initiated with complete customer management integration
[2025-06-06 03:09:50.522 +03:00 INF] : Database configuration - UseExplicitTransactions: true, EnableRetryOnFailure: false
[2025-06-06 03:09:50.705 +03:00 INF] : Service configuration completed successfully with 115 services registered (complete customer management integration)
[2025-06-06 03:09:50.797 +03:00 INF] Microsoft.Hosting.Lifetime: Application started. Press Ctrl+C to shut down.
[2025-06-06 03:09:50.810 +03:00 INF] Microsoft.Hosting.Lifetime: Hosting environment: Production
[2025-06-06 03:09:50.811 +03:00 INF] Microsoft.Hosting.Lifetime: Content root path: C:\Users\$\Desktop\poultry version\7\PoultrySlaughterPOS\PoultrySlaughterPOS\bin\Debug\net8.0-windows
[2025-06-06 03:09:50.811 +03:00 INF] : Application host built and started successfully with complete customer management integration
[2025-06-06 03:09:50.961 +03:00 INF] : Database initialization started
[2025-06-06 03:09:50.964 +03:00 INF] PoultrySlaughterPOS.Services.DatabaseInitializationService: Starting database initialization for SQL Server...
[2025-06-06 03:09:52.031 +03:00 INF] PoultrySlaughterPOS.Services.DatabaseInitializationService: Verifying SQL Server instance with connection: Server=.\posserver;Database=chicken;Trusted_Connection=True;MultipleActiveResultSets=true;TrustServerCertificate=True
[2025-06-06 03:09:52.550 +03:00 INF] PoultrySlaughterPOS.Services.DatabaseInitializationService: Testing SQL Server connection...
[2025-06-06 03:09:52.662 +03:00 INF] PoultrySlaughterPOS.Services.DatabaseInitializationService: SQL Server connection successful.
[2025-06-06 03:09:52.936 +03:00 INF] PoultrySlaughterPOS.Services.DatabaseInitializationService: Database 'chicken' created/verified successfully.
[2025-06-06 03:09:53.503 +03:00 INF] PoultrySlaughterPOS.Services.DatabaseInitializationService: Database schema verification completed:
[2025-06-06 03:09:53.503 +03:00 INF] PoultrySlaughterPOS.Services.DatabaseInitializationService: - TRUCKS: 3 records
[2025-06-06 03:09:53.503 +03:00 INF] PoultrySlaughterPOS.Services.DatabaseInitializationService: - CUSTOMERS: 4 records
[2025-06-06 03:09:53.503 +03:00 INF] PoultrySlaughterPOS.Services.DatabaseInitializationService: - TRUCK_LOADS: 6 records
[2025-06-06 03:09:53.503 +03:00 INF] PoultrySlaughterPOS.Services.DatabaseInitializationService: - INVOICES: 40 records
[2025-06-06 03:09:53.503 +03:00 INF] PoultrySlaughterPOS.Services.DatabaseInitializationService: - PAYMENTS: 8 records
[2025-06-06 03:09:53.504 +03:00 INF] PoultrySlaughterPOS.Services.DatabaseInitializationService: - DAILY_RECONCILIATION: 0 records
[2025-06-06 03:09:53.504 +03:00 INF] PoultrySlaughterPOS.Services.DatabaseInitializationService: - AUDIT_LOGS: 104 records
[2025-06-06 03:09:53.504 +03:00 INF] PoultrySlaughterPOS.Services.DatabaseInitializationService: Database initialization completed successfully.
[2025-06-06 03:09:53.504 +03:00 INF] : Database initialization completed successfully
[2025-06-06 03:09:54.058 +03:00 INF] : SQL Server retry strategy disabled to support explicit transactions
[2025-06-06 03:09:54.702 +03:00 WRN] Microsoft.EntityFrameworkCore.Query: The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
[2025-06-06 03:09:54.720 +03:00 INF] PoultrySlaughterPOS.MainWindow: MainWindow initialized successfully with complete customer management support
[2025-06-06 03:09:55.081 +03:00 INF] : SQL Server retry strategy disabled to support explicit transactions
[2025-06-06 03:09:55.786 +03:00 ERR] Microsoft.EntityFrameworkCore.Query: An exception occurred while iterating over the results of a query for context type 'PoultrySlaughterPOS.Data.PoultryDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
[2025-06-06 03:09:55.963 +03:00 ERR] PoultrySlaughterPOS.Services.Repositories.CustomerRepository: Error retrieving debt summary
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.CustomerRepository.GetDebtSummaryAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\poultry version\7\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\CustomerRepository.cs:line 177
[2025-06-06 03:09:56.143 +03:00 INF] PoultrySlaughterPOS.MainWindow: MainWindow loaded successfully
[2025-06-06 03:09:56.162 +03:00 INF] : Main window created and displayed successfully
[2025-06-06 03:09:56.162 +03:00 INF] : === Poultry Slaughter POS Application Started Successfully ===
[2025-06-06 03:09:56.175 +03:00 INF] PoultrySlaughterPOS.MainWindow: Dashboard statistics loaded successfully - Trucks: 3, Customers: 4, Invoices: 0, Debt: ¤100.25
[2025-06-06 03:09:56.255 +03:00 ERR] PoultrySlaughterPOS.MainWindow: Error loading dashboard statistics
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.CustomerRepository.GetDebtSummaryAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\poultry version\7\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\CustomerRepository.cs:line 177
   at PoultrySlaughterPOS.MainWindow.LoadDashboardStatisticsAsync() in C:\Users\$\Desktop\poultry version\7\PoultrySlaughterPOS\PoultrySlaughterPOS\MainWindow.xaml.cs:line 527
[2025-06-06 03:09:56.260 +03:00 WRN] PoultrySlaughterPOS.MainWindow: Status message (Error): خطأ في تحميل إحصائيات النظام
[2025-06-06 03:09:56.261 +03:00 INF] PoultrySlaughterPOS.MainWindow: Initial dashboard loaded successfully
[2025-06-06 03:09:57.612 +03:00 INF] : SQL Server retry strategy disabled to support explicit transactions
[2025-06-06 03:09:57.678 +03:00 INF] PoultrySlaughterPOS.ViewModels.POSViewModel: POSViewModel initialized with invoice search and edit capabilities
[2025-06-06 03:09:57.679 +03:00 INF] PoultrySlaughterPOS.ViewModels.POSViewModel: POSViewModel initialized with invoice search and edit capabilities
[2025-06-06 03:09:57.809 +03:00 INF] PoultrySlaughterPOS.Views.POSView: Enhanced POSView initialized successfully with search and edit capabilities
[2025-06-06 03:09:57.809 +03:00 INF] PoultrySlaughterPOS.Views.POSView: POSView ViewModel set successfully
[2025-06-06 03:09:57.809 +03:00 INF] PoultrySlaughterPOS.MainWindow: POS view created and configured successfully
[2025-06-06 03:09:57.812 +03:00 INF] PoultrySlaughterPOS.Views.POSView: Initializing enhanced POSView with comprehensive data loading and search capabilities
[2025-06-06 03:09:58.269 +03:00 INF] PoultrySlaughterPOS.Views.POSView: Initializing enhanced POSView with comprehensive data loading and search capabilities
[2025-06-06 03:09:58.292 +03:00 INF] PoultrySlaughterPOS.ViewModels.POSViewModel: Loaded 4 active customers
[2025-06-06 03:09:58.409 +03:00 INF] PoultrySlaughterPOS.ViewModels.POSViewModel: Loaded 3 active trucks
[2025-06-06 03:09:58.518 +03:00 INF] PoultrySlaughterPOS.ViewModels.POSViewModel: Loaded 4 active customers
[2025-06-06 03:09:58.519 +03:00 INF] PoultrySlaughterPOS.Repositories.InvoiceRepository: Generated optimized invoice number: 202506060001
[2025-06-06 03:09:58.648 +03:00 INF] PoultrySlaughterPOS.ViewModels.POSViewModel: Real invoice number generated and set: 202506060001
[2025-06-06 03:09:58.649 +03:00 INF] PoultrySlaughterPOS.ViewModels.POSViewModel: POSViewModel initialized successfully with search and edit capabilities
[2025-06-06 03:09:58.656 +03:00 INF] PoultrySlaughterPOS.Views.POSView: Enhanced POSView initialization completed successfully
[2025-06-06 03:09:58.657 +03:00 INF] PoultrySlaughterPOS.Views.POSView: POSView async initialization completed successfully
[2025-06-06 03:09:58.657 +03:00 INF] PoultrySlaughterPOS.MainWindow: Successfully navigated to POSSales
[2025-06-06 03:09:58.680 +03:00 INF] PoultrySlaughterPOS.ViewModels.POSViewModel: Loaded 3 active trucks
[2025-06-06 03:09:58.794 +03:00 INF] PoultrySlaughterPOS.Repositories.InvoiceRepository: Generated optimized invoice number: 202506060001
[2025-06-06 03:09:58.794 +03:00 INF] PoultrySlaughterPOS.ViewModels.POSViewModel: Real invoice number generated and set: 202506060001
[2025-06-06 03:09:58.795 +03:00 INF] PoultrySlaughterPOS.ViewModels.POSViewModel: POSViewModel initialized successfully with search and edit capabilities
[2025-06-06 03:09:58.795 +03:00 INF] PoultrySlaughterPOS.Views.POSView: Enhanced POSView initialization completed successfully
[2025-06-06 03:09:58.799 +03:00 INF] PoultrySlaughterPOS.Views.POSView: Applying emergency TextBox visibility fix
[2025-06-06 03:09:58.809 +03:00 INF] PoultrySlaughterPOS.Views.POSView: Emergency TextBox visibility fix applied successfully
[2025-06-06 03:09:58.810 +03:00 INF] PoultrySlaughterPOS.Views.POSView: Applying emergency TextBox visibility fix
[2025-06-06 03:09:58.818 +03:00 INF] PoultrySlaughterPOS.Views.POSView: Emergency TextBox visibility fix applied successfully
[2025-06-06 03:10:21.435 +03:00 INF] PoultrySlaughterPOS.MainWindow: Application closing initiated - performing comprehensive cleanup
[2025-06-06 03:10:21.439 +03:00 INF] PoultrySlaughterPOS.MainWindow: Starting comprehensive resource cleanup
[2025-06-06 03:10:21.479 +03:00 INF] PoultrySlaughterPOS.ViewModels.POSViewModel: POSViewModel cleanup completed successfully
[2025-06-06 03:10:21.489 +03:00 INF] PoultrySlaughterPOS.MainWindow: Resource cleanup completed successfully
[2025-06-06 03:10:21.490 +03:00 INF] PoultrySlaughterPOS.MainWindow: Application cleanup completed successfully
[2025-06-06 03:10:21.584 +03:00 INF] : === Poultry Slaughter POS Application Shutdown Initiated ===
[2025-06-06 03:10:21.591 +03:00 INF] Microsoft.Hosting.Lifetime: Application is shutting down...
[2025-06-06 03:10:21.616 +03:00 INF] : Application host stopped and disposed successfully
[2025-06-06 03:10:21.619 +03:00 INF] : === Poultry Slaughter POS Application Shutdown Completed ===
